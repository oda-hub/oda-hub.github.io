<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Workflow development Guide Workflows are all things that can be computed, broadly speaking.
For reproducibility, we want our workflows to be repeatable: producing the same output every time they are computed. This is easy enough to do in first approximation, but might be harder to achieve than it seems when the workflow relies on external resources. But we track every execution so it is not necessary to be overly concerned about these delicate details at every moment.">
<meta name="theme-color" content="#FFFFFF"><meta property="og:title" content="" />
<meta property="og:description" content="Workflow development Guide Workflows are all things that can be computed, broadly speaking.
For reproducibility, we want our workflows to be repeatable: producing the same output every time they are computed. This is easy enough to do in first approximation, but might be harder to achieve than it seems when the workflow relies on external resources. But we track every execution so it is not necessary to be overly concerned about these delicate details at every moment." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://odahub.io/docs/guide-development/" />

<title>Guide Development | About ODA</title>
<link rel="manifest" href="../../manifest.json">
<link rel="icon" href="../../favicon.png" type="image/x-icon">
<link rel="stylesheet" href="../../book.min.0be8d61b557097f76ada0b8f654a7cfbb4ce4456162d2df1ffb7117c6b42d7c0.css" integrity="sha256-C&#43;jWG1Vwl/dq2guPZUp8&#43;7TORFYWLS3x/7cRfGtC18A=" crossorigin="anonymous">
  <script defer src="../../flexsearch.min.js"></script>
  <script defer src="../../en.search.min.7bdc73864a8ac27b03652d535c27a996fba53aee05c945ef352ebadcff90a83c.js" integrity="sha256-e9xzhkqKwnsDZS1TXCeplvulOu4FyUXvNS663P&#43;QqDw=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a href="../../"><span>About ODA</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>











  



  
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://odahub.io/docs/guide-development/" class=" active">Guide Development</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://odahub.io/docs/guide-discovery/" class="">Guide Discovery</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://odahub.io/docs/guide-ontology/" class="">Guide Ontology</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://odahub.io/docs/issues/" class="">Issues</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://odahub.io/docs/reasoning-engine/" class="">Reasoning Engine</a>
  

        </li>
      
    
  </ul>















</nav>




  <script>(function(){var menu=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="../../svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Guide Development</strong>

  <label for="toc-control">
    
    <img src="../../svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#guide-to-a-simple-oda-jupyter-notebook-workflow">Guide to a simple ODA Jupyter Notebook workflow</a></li>
    <li><a href="#workflows-development-progression-towards-python-modules-packages-apis">Workflows development progression: towards python modules, packages, API&rsquo;s</a></li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="workflow-development-guide">Workflow development Guide</h1>
<p>Workflows are all things that can be computed, broadly speaking.</p>
<p>For reproducibility, we want our workflows to be repeatable: producing the same output every time they are computed.
This is easy enough to do in first approximation, but might be harder to achieve than it seems when the workflow relies on external resources. But we track every execution so it is not necessary to be overly concerned about these delicate details at every moment.</p>
<p>Generally, we want the workflows to be parametrized. Non-parametrized but strickly repeatable notebooks are equivalent to their output data.</p>
<p>One way to create them in ODA is to build <strong>jupyter notebook</strong>.</p>
<h2 id="guide-to-a-simple-oda-jupyter-notebook-workflow">Guide to a simple ODA Jupyter Notebook workflow</h2>
<ul>
<li>write your notebook, and make sure it runs from top to bottom</li>
<li>make a requirements.txt will the modules you need for this notebook</li>
<li>parameterize the notebook, by creating cell with the following tag &ldquo;parameters&rdquo; (see <a href="https://papermill.readthedocs.io/en/latest/usage-parameterize.html#designate-parameters-for-a-cell">papermill manual</a>):</li>
<li>define the notebook output, similarly creating cell with tag &ldquo;outputs&rdquo;.
<ul>
<li>outputs may be strings, floats, lists</li>
<li>outputs may be also strings which contain filenames for valid files. If they do, the whole file will be considered output.</li>
</ul>
</li>
<li>install nb2workflow tooling <code>pip install nb2workflow[cwl,oda] --upgrade</code></li>
<li>inspect the notebook <code>nbinspect my-notebook.ipynb</code></li>
<li>try to run the notebook <code>nbrun my-notebook.ipynb</code>
<ul>
<li>it will use all default parameters</li>
<li>you can specify parameters as <code>nbrun --inp-nbins=10 my-notebook.ipynb</code>, if <code>nbins</code> happens to be one of the parameters.</li>
</ul>
</li>
<li>try to start the service <code>nb2service my-notebook.ipynb</code></li>
</ul>
<h2 id="workflows-development-progression-towards-python-modules-packages-apis">Workflows development progression: towards python modules, packages, API&rsquo;s</h2>
<p>At some point, it may be advisable to move part of code in functions of a <strong>python module</strong> (e.g. <code>my_functions.py</code>), stored in the same repository. The functions can be called from the workflow notebook as <code>from my_functions import my_nice_function; my_nice_function(argument)</code>.</p>
<p>If some functions are often re-used, they can be stored in external packages, and even published on <strong>pypi</strong> (to allow <code>pip install my_function_package</code>).</p>
<p>Sometimes, the <strong>function may be in fact called remotely, though API</strong>. From the point of view of workflow (e.g. notebook) where the function is called there such a remotely executed function may look very similar to local function from a module, giving similar advantages and posing similar challenges.</p>
<p>On should be wary that extracting the functions <strong>somewhat obscure content of the workflow, by introducing structure which is not generally automatically traced by workflow execution provenance tracking</strong>.<br>
So when reusable part of the workflow matures, it may be extracted and treated as another workflow, providing inputs to the current workflow under development.</p>
<p>It is not feasible to always design workflow to use other workflows by consuming some pre-computed inputs. As described above in this section, workflow development progression often separates some function from within the workflow, or uses.
<strong>SmarkSky</strong> project and in a way in general <strong>renku plugins</strong> essentially acknowledges this feature of the workflows: they use external functions from within the code at random locations, possibly calling them multiple times.</p>
<p>This additional information about functions called by the workflow can be introduced to the workflow metadata with special annotations (see more about workflow annotation in <a href="https://github.com/oda-hub/workflow-discovery">ODA Workflow Publishing and Discovery Guide</a>), such as <code>oda:requestsAstroqueryService</code>. These annotations should be also include information about parameters used to annotate the workflow.
This additional structure associated with workflows will be ingested in the KG. While <strong>it can not be directly interpretted as workflow provenance graph, it is possible to produce additional similar-looking graph with inferred provenance, which is different but analogous to strict renku-derivde provenance</strong>.</p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function select(element){const selection=window.getSelection();const range=document.createRange();range.selectNodeContents(element);selection.removeAllRanges();selection.addRange(range);}
document.querySelectorAll("pre code").forEach(code=>{code.addEventListener("click",function(event){select(code.parentElement);if(navigator.clipboard){navigator.clipboard.writeText(code.parentElement.textContent);}});});})();</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#guide-to-a-simple-oda-jupyter-notebook-workflow">Guide to a simple ODA Jupyter Notebook workflow</a></li>
    <li><a href="#workflows-development-progression-towards-python-modules-packages-apis">Workflows development progression: towards python modules, packages, API&rsquo;s</a></li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












